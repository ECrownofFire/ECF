<main id="thread-list">
<a href="{{base}}/">Home</a>
<button id="button-edit" type="button" onclick="return editForum();" style="visibility: hidden;">Edit</button>
<form id="form-edit" style="visibility: hidden;" onsubmit="return doEditForum();">
    <label>Name<input id='form-name' name="name" value="{{forum}}"></label>
    <label>Description<input id='form-desc' name="desc" value="{{forum_desc}}"></label>
    <button>Submit Changes</button>
</form>
<form id="form-delete" style="visibility: hidden;" onsubmit="return doDeleteForum();"><button onclick="return confirm('Are you sure you want to delete this forum and every thread and post in it?');">Delete</button></form>
<h2>{{forum}}</h2>
<p>{{forum_desc}}</p>
<script>
(function() {
    checkPermission('forum', {{forum_id}}, 'edit_forum',
        function(response) {
            if (response.success) {
                var btn = document.getElementById('button-edit');
                btn.style.visibility = "visible";
            }
        });
    checkPermission('forum', {{forum_id}}, 'delete_forum',
        function(response) {
            if (response.success) {
                var form = document.getElementById('form-delete');
                form.style.visibility = "visible";
            }
        });
})()

function editForum() {
    var form = document.getElementById('form-edit');
    form.style.visibility = (form.style.visibility === "hidden") ? "visible" : "hidden";
}

function doEditForum() {
    var xhr = new XMLHttpRequest();
    var name = encodeURIComponent(document.getElementById('form-name').value);
    var desc = encodeURIComponent(document.getElementById('form-desc').value);
    xhr.open("PATCH", "{{base}}/forum/{{forum_id}}");
    var req = "name=" + name + "&desc=" + desc;
    xhr.onload = function(e) {
        location.reload();
    }
    xhr.send(req);
    return false;
}

function doDeleteForum() {
    var xhr = new XMLHttpRequest();
    xhr.open("DELETE", "{{base}}/forum/{{forum_id}}");
    xhr.onload = function() {
        location.href = "{{base}}/";
    }
    xhr.send();
    return false;
}
</script>
<table>
    <thead>
        <tr>
            <th>Title</th>
            <th>Replies</th>
            <th>Creator</th>
            <th>Last Post</th>
        </tr>
    </thead>
    <tbody>

